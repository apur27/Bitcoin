# Ultimate Bitcoin Price Forecaster

A **state-of-the-art ensemble modelling pipeline** that brings together traditional machine-learning, deep-learning and time-series techniques to predict daily Bitcoin returns and price paths.

The project is centred around the `UltimateBitcoinForecaster` class (see [`bitcoinML7.py`](./bitcoinML7.py)) which:

* Pulls historical price and volume from TwelveData / Binance
* Enriches the dataset with on-chain, macro-economic and sentiment signals
* Derives more than 150 technical indicators and crypto-specific cycle features
* Detects market regimes and engineers directional-movement statistics
* Trains an ensemble of:
  * XGBoost
  * Bidirectional LSTM + Attention
  * Facebook Prophet
  * CatBoost
  * Quantile Gradient Boosting (LightGBM)
* Combines the models with static weights and regime-specific weak-learners
* Provides prediction intervals and a dedicated up/down classifier
* Exports ready-to-use artefacts: model pickles, forecast PNGs and CSVs

---

## 1  Installation

```bash
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
```
Python 3.11 or newer is recommended. GPU-enabled TensorFlow will be picked up automatically if available.

---

## 2  API Keys

The following environment variables are used when fetching external data:

* `TWELVE_API_KEY` – required to download historical OHLC data from [twelvedata.com](https://twelvedata.com/).
* `FRED_API_KEY` – optional, enables macro-economic features from the St. Louis FED.

Set them in your shell (add to `~/.bashrc` if desired):

```bash
export TWELVE_API_KEY="YOUR_12DATA_KEY"
export FRED_API_KEY="YOUR_FRED_KEY"
```

---

## 3  Quick Start using the CLI

A lightweight wrapper `run_forecasting.py` is included for day-to-day operations.

1. **Fetch / refresh data** (max 5000 days):

   ```bash
   python run_forecasting.py --fetch --days 2000
   ```

2. **Train** the full modelling stack:

   ```bash
   python run_forecasting.py --train
   ```

3. **Predict** the next 30 days (using the trained models):

   ```bash
   python run_forecasting.py --predict 30
   ```

You can chain the steps in a single command:

```bash
python run_forecasting.py --fetch --train --predict 30
```

---

## 4  Produced Outputs

* `bitcoin_forecast.log`                             – comprehensive run log
* `bitcoin_forecast.png`                             – actual vs. predicted returns plot
* `bitcoin_future_predictions.csv`         – table with point & interval forecasts
* `xgb_model.pkl`, `lstm_model.h5`, …   – trained model artefacts

---

## 5  Disclaimer

Cryptocurrency markets are **extremely volatile and speculative**. The forecasts generated by this project are for **educational and research purposes only** and must **not** be considered financial advice. Use at your own risk.
